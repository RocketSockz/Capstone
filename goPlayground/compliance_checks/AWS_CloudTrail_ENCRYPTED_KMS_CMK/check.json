{
  "id": "a5141482-6c8c-e18a-8053-b0d214c4c716",
  "displayName": "Ensure CloudTrail logs are encrypted at rest using KMS CMKs",
  "resourceType": "AWS::CloudTrail::Trail",
  "severity": "medium",
  "rationale": "Configuring CloudTrail to use SSE-KMS provides additional confidentiality controlson log data as a given user must have S3 read permission on the corresponding log bucket and must be granted decrypt permission by the CMK policy.",
  "source": "cis aws 1.3.0 | benchmark 3.7",
  "recommended_action": "Perform the following to configure CloudTrail to use SSE-KMS:\nVia the Management Console\n1. Sign in to the AWS Management Console and open the CloudTrail console at\nhttps://console.aws.amazon.com/cloudtrail\n2. In the left navigation pane, choose Trails\n3. Click on a Trail\n4. Under the General Details section click on the edit button (pencil icon)\n5. Select an existing CMK from the KMS key Id drop-down menu\nNote: Ensure the CMK is located in the same region as the S3 bucket\nNote: You will need to apply a KMS Key policy on the selected CMK in order for\nCloudTrail as a service to encrypt and decrypt log files using the CMK provided.\nSteps are provided here for editing the selected CMK Key policy\n6. Click Save",
  "error_message": "CloudTrail does not have KMS key correctly attached",
  "category": "AU",
  "subcategory": "",
  "ruleNames": [
    "Ensure CloudTrail logs are encrypted at rest using KMS CMKs"
  ]
}