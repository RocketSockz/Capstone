{
  "id": "3dea416f-3aa3-0fdb-fed3-cd85b4f0e16d",
  "displayName": "Ensure the key vault is recoverable via purge protection",
  "resourceType": "Microsoft.KeyVault/vaults",
  "severity": "high",
  "rationale": "There could be scenarios where users accidently run delete/purge commands on key vault or attacker/malicious user does itdeliberately to cause disruption. Deleting or purging a key vault leads to immediate data loss as keys encrypting data and secrets/certificates allowing access/services will become non-accessible.",
  "source": "cis azure 1.1.0 | benchmark 8.4",
  "recommended_action": "To enable \"Purge Protection\" for a Key Vault:\nVia Azure Portal\nAzure Portal does not have provision to update the respective configurations\nVia Azure CLI 2.0\naz resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault\n/vaults/<keyVaultName> --set properties.enablePurgeProtection=true",
  "error_message": "Purge Protection is required for Key Vaults",
  "category": "SC",
  "subcategory": "",
  "ruleNames": [
    "Ensure key vaults are recoverable by enabling 'Purge Protection'"
  ]
}