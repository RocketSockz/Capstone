{
  "errorMessage": "Purge Protection is required for Key Vaults",
  "recommended_action": "To enable \"Purge Protection\" for a Key Vault:\nVia Azure Portal\nAzure Portal does not have provision to update the respective configurations\nVia Azure CLI 2.0\naz resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault\n/vaults/<keyVaultName> --set properties.enablePurgeProtection=true",
  "rationale": "There could be scenarios where users accidently run delete/purge commands on key vault or attacker/malicious user does itdeliberately to cause disruption. Deleting or purging a key vault leads to immediate data loss as keys encrypting data and secrets/certificates allowing access/services will become non-accessible.",
  "source": "cis azure 1.1.0",
  "properties": {
    "document": {
      "properties": {
        "properties": {
          "properties": {
            "enablePurgeProtection": {
              "const": true,
              "errorMessage": "Purge Protection is not enabled for this Key Vault."
            }
          },
          "errorMessage": "Purge Protection settings cannot be found for this Key Vault.",
          "required": ["enablePurgeProtection"]
        }
      }
    }
  },
  "schemaId": "3dea416f-3aa3-0fdb-fed3-cd85b4f0e16d"
}
