{
  "id": "9667e484-ef82-bb8e-d90c-971fdfb8e655",
  "displayName": "Ensure the key vault is recoverable via soft delete",
  "resourceType": "Microsoft.KeyVault/vaults",
  "severity": "high",
  "rationale": "There could be scenarios where users accidently run delete/purge commands on key vault or attacker/malicious user does itdeliberately to cause disruption. Deleting or purging a key vault leads to immediate data loss as keys encrypting data and secrets/certificates allowing access/services will become non-accessible.",
  "source": "cis azure 1.1.0 | benchmark 8.4",
  "recommended_action": "To enable \"Soft Delete\" for a Key Vault:\nVia Azure Portal\nAzure Portal does not have provision to update the respective configurations\nVia Azure CLI 2.0\naz resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault\n/vaults/<keyVaultName> --set properties.enableSoftDelete=true",
  "error_message": "Soft Delete are required for a Key Vault",
  "category": "SC",
  "subcategory": "",
  "ruleNames": [
    "Ensure key vaults are recoverable by enabling 'Soft Delete'"
  ]
}