{
  "resourceType": "databases/oracle",
  "id": "68df068c-323e-4283-ae7e-3e0ec50de14b",
  "displayName": "Ensure 'EXECUTE' is revoked from 'PUBLIC' on \"Network\" Packages",
  "severity": "high",
  "source": "oracle-benchmark",
  "category": "DB",
  "rationale": "As described below, Oracle Database PL/SQL packages - `DBMS_LDAP`, `UTL_INADDR`, `UTL_TCP`, `UTL_MAIL`, `UTL_SMTP`, `UTL_DBWS`, `UTL_ORAMTS`, `UTL_HTTP` and type `HTTPURITYPE` can be used by unauthorized users to create specially crafted error messages or send information to external servers. The `PUBLIC` should not be able to execute these packages.\n- The use of the `DBMS_LDAP` package can be used to create specially crafted error messages or send information via DNS to the outside.\n- The `UTL_INADDR` package can be used to create specially crafted error messages or send information via DNS to the outside.\n- The `UTL_TCP` package could allow an unauthorized user to corrupt the TCP stream used to carry the protocols that communicate with the instance's external communications.\n- The `UTL_MAIL` package could allow an unauthorized user to corrupt the SMTP function to accept or generate junk mail that can result in a denial-of-service condition due to network saturation.\n- The `UTL_SMTP` package could allow an unauthorized user to corrupt the SMTP function to accept or generate junk mail that can result in a denial-of-service condition due to network saturation.\n- The `UTL_DBWS` package could allow an unauthorized user to corrupt the HTTP stream used to carry the protocols that communicate for the instance's web-based external communications.\n- The `UTL_ORAMTS` package could be used to send (sensitive) information to external websites. The use of this package should be restricted according to the needs of the organization.\n- The `UTL_HTTP` package could be used to send (sensitive) information to external websites.\n- The use of this package should be restricted according to the needs of the organization.\n- The ability to perform HTTP requests could be used to leak information from the database to an external destination.",
  "recommended_action": "To remediate this setting, execute the following SQL statement, keeping in mind if this is granted in both container and pluggable database, you must connect to both places to revoke.\n```\nREVOKE EXECUTE ON DBMS_LDAP FROM PUBLIC;\nREVOKE EXECUTE ON UTL_INADDR FROM PUBLIC;\nREVOKE EXECUTE ON UTL_TCP FROM PUBLIC;\nREVOKE EXECUTE ON UTL_MAIL FROM PUBLIC;\nREVOKE EXECUTE ON UTL_SMTP FROM PUBLIC;\nREVOKE EXECUTE ON UTL_DBWS FROM PUBLIC;\nREVOKE EXECUTE ON UTL_ORAMTS FROM PUBLIC;\nREVOKE EXECUTE ON UTL_HTTP FROM PUBLIC;\nREVOKE EXECUTE ON HTTPURITYPE FROM PUBLIC;\n```",
  "error_message": "'EXECUTE' permissions found on one or more 'PUBLIC' 'NETWORK' package",
  "subcategory": "",
  "ruleNames": [
    "Ensure 'EXECUTE' is revoked from 'PUBLIC' on \"Network\" Packages"
  ]
}