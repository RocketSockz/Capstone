{
  "id": "94cc3356-376c-4d81-8daa-423f103df497",
  "displayName": "Ensure 'Maximum number of error log files' is set to greater than or equal to '12'",
  "resourceType": "databases/mssqlserver",
  "severity": "low",
  "rationale": "The SQL Server error log contains important information about major server events and login attempt information as well.",
  "source": "sql-server benchmark",
  "recommended_action": "Adjust the number of logs to prevent data loss. The default value of `6` may be insufficient for a production environment. Perform either the GUI or T-SQL method shown:\r\n#### GUI Method\r\n1. Open **SQL Server Management Studio**.\r\n2. Open **Object Explorer** and connect to the target instance.\r\n3. Navigate to the **Management** tab in **Object Explorer** and expand. Right click on the **SQL Server Logs** file and select **Configure**\r\n4. Check the **Limit the number of error log files before they are recycled**\r\n5. Set the **Maximum number of error log files** to greater than or equal to `12`\r\n#### T-SQL Method\r\nRun the following T-SQL to change the number of error log files, replace _`<NumberAbove12>`_ with your desired number of error log files:\r\n```\r\nEXEC master.sys.xp_instance_regwrite\r\nN'HKEY_LOCAL_MACHINE',\r\nN'Software\\Microsoft\\MSSQLServer\\MSSQLServer',\r\nN'NumErrorLogs',\r\nREG_DWORD,\r\n<NumberAbove12>;\r\n```",
  "error_message": "Maximum number of error log files is less than 12",
  "subcategory": "",
  "category": "",
  "ruleNames": [
    "Ensure 'Maximum number of error log files' is set to greater than or equal to '12'"
  ]
}