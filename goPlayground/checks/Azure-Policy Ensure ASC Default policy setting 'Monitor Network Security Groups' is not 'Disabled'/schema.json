{
  "recommended_action": "1. Navigate to Azure Policy\n2. On Policy \"Overview\" blade, Click on Policy ASC Default\n(Subscription:Subscription_ID)\n3. On \"ASC Default\" blade, Click on Edit Assignments\n4. In section PARAMETERS, Set Monitor Network Security Groups to AuditIfNotExists or any\nother available value than Disabled\n5. Click Save",
  "rationale": "When this setting is enabled, it recommends that network security groups be configured to control inbound and outbound traffic to VMs that have public endpoints. Network security groups that are configured for a subnet are inherited by all virtual machine network interfaces unless otherwise specified. In addition to checking that a network security group has been configured, this policy assesses inbound security rules to identify rules that allow incoming traffic.",
  "source": "cis azure 1.1.0",
  "properties": {
    "document": {
      "if": {
        "properties": {
          "name": {
            "constIgnoreCase": "securitycenterbuiltin"
          }
        }
      },
      "then": {
        "properties": {
          "properties": {
            "errorMessage": "Network security group monitoring is disabled.",
            "properties": {
              "parameters": {
                "properties": {
                  "networkSecurityGroupsMonitoringEffect": {
                    "properties": {
                      "value": {
                        "minLength": 1,
                        "not": {
                          "errorMessage": "Network security group monitoring is disabled.",
                          "constIgnoreCase": "disabled"
                        }
                      }
                    }
                  }
                },
                "required": ["networkSecurityGroupsMonitoringEffect"]
              }
            },
            "required": ["parameters"]
          }
        }
      },
      "errorMessage": "Network security group monitoring is disabled."
    }
  },
  "schemaId": "cb9aa89e-7c2b-8f54-6ab8-f7851413a437"
}
