{
  "recommended_action": "1. Create a metric filter based on filter pattern provided which checks for\nunauthorized API calls and the <cloudtrail_log_group_name> taken from audit\n2. Create an SNS topic that the alarm will notify\n3. Create an SNS subscription to the topic created in step 2\n4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in\nstep 1 and an SNS topic created in step 2",
  "rationale": "The AWS API call history produced by CloudTrail enables security analysis, resource change tracking, and compliance auditing.",
  "source": "cis aws 1.2.0",
  "properties": {
    "document": {
      "properties": {
        "IsMultiRegionTrail": {
          "errorMessage": "CloudTrail must be enabled for all regions.",
          "const": true
        }
      },
      "required": ["IsMultiRegionTrail"]
    },
    "trailStatus": {
      "properties": {
        "isLogging": {
          "errorMessage": "Multi-region CloudTrails are not logging properly.",
          "const": true
        }
      }
    },
    "eventSelectors": {
      "errorMessage": "CloudTrail does not contain properly configured event selectors.",
      "contains": {
        "properties": {
          "IncludeManagementEvents": {
            "const": true
          },
          "ReadWriteType": {
            "constIgnoreCase": "all"
          }
        },
        "required": ["ReadWriteType", "IncludeManagementEvents"]
      }
    }
  },
  "schemaId": "5bb9e661-4fa7-5e8c-cb5d-6e6a2e12d4dd"
}
