{
  "recommended_action": "1. Go to Kubernetes GCP Console by visiting\nhttps://console.cloud.google.com/kubernetes/list?\n2. Click on CREATE CLUSTER\n3. Choose required name/value for cluster fields\n4. Click on More\n5. Choose Service account which has the least privilege under Project access section,\nInstead of default Compute Engine default service account",
  "rationale": "You should create and use a minimally privileged service account to run your Kubernetes Engine cluster instead of using the Compute Engine default service account. If you are not creating a separate service account for your nodes, you should limit the scopes of the node service account to reduce the possibility of a privilege escalation in an attack. Kubernetes Engine requires, at a minimum, the service account to have the monitoring.viewer, monitoring.metricWriter, and logging.logWriter roles. This ensures that your default service account does not have permissions beyond those necessary to run your cluster. While the default scopes are limited, they may include scopes beyond the minimally required scopes needed to run your cluster.",
  "source": "cis gcp 1.0.0",
  "properties": {
    "document": {
      "properties": {
        "nodePools": {
          "items": {
            "properties": {
              "config": {
                "properties": {
                  "serviceAccount": {
                    "not": {
                      "errorMessage": "Kubernetes cluster uses default service account.",
                      "constIgnoreCase": "default"
                    },
                    "errorMessage": "Kubernetes cluster uses default service account."
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "schemaId": "9a0159f5-1fec-735f-d1ec-eda217e18d9f"
}
