{
  "recommended_action": "1. Go to SQL servers\n2. For this SQL server, click on Active Directory admin\n3. Click on Set admin\n4. Select an admin\n5.  Click Save",
  "rationale": "Azure Active Directory authentication is a mechanism to connect to Microsoft Azure SQL Database and SQL Data Warehouse by using identities in Azure Active Directory (Azure AD). With Azure AD authentication, identities of database users and other Microsoft services can be managedin one central location. Central ID management provides a single place to manage database users and simplifies permission management.",
  "source": "cis azure 1.1.0",
  "properties": {
    "administrators": {
      "items": {
        "allOf": [
          {
            "properties": {
              "properties": {
                "errorMessage": "SQL server does not have Azure active directory admin correctly configured.",
                "properties": {
                  "administratorType": {
                    "enumIgnoreCase": ["activedirectory"]
                  },
                  "login": {
                    "type": "string"
                  },
                  "sid": {
                    "type": "string"
                  },
                  "tenantId": {
                    "type": "string"
                  }
                },
                "required": ["administratorType", "login", "sid", "tenantId"]
              }
            }
          }
        ]
      }
    }
  },
  "errorMessage": "SQL server does not have Azure active directory admin.",
  "required": ["administrators"],
  "schemaId": "20c8ed55-5465-2c7d-b69f-5fc2b7640ce7"
}
