{
  "recommended_action": "1. Go to the VM instances page using\nhttps://console.cloud.google.com/compute/instances?. It will list all the\ninstances from project\n2. Click on the name of the Impacted instance\n3. Click Edit in the toolbar\n4. Under SSH Keys, go to the Block project-wide SSH keys checkbox\n5. To block users with project-wide SSH keys from connecting to this instance, select\nBlock project-wide SSH keys\n6. click Save at the bottom of the page\n7. Repeat steps for every impacted Instance",
  "rationale": "Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.",
  "source": "cis gcp 1.0.0",
  "properties": {
    "document": {
      "properties": {
        "metadata": {
          "properties": {
            "items": {
              "contains": {
                "properties": {
                  "key": {
                    "constIgnoreCase": "block-project-ssh-keys"
                  },
                  "value": {
                    "constIgnoreCase": "true"
                  }
                }
              },
              "errorMessage": "Block project-wide SSH keys setting are disabled."
            }
          }
        }
      }
    }
  },
  "schemaId": "06c59743-f832-f360-6eaa-3996f0cf2d5e"
}
