{
  "recommended_action": "1. Go to VPC Network.\n2. Go to the Firewall Rules.\n3. Click this Firewall Rule.\n4. Click Edit.\n5. Modify Source IP ranges to specific IP.\n6. Click Save.",
  "rationale": "GCP Firewall Rules within a VPC Network. These rules apply to outgoing (egress) traffic from instances and incoming (ingress) traffic to instances in the network. Egress and ingress traffic are controlled even if the traffic stays within the network (for example, instance-to-instance communication). For an instance to have outgoing Internet access, the network must have a valid Internet gateway route or custom route whose destination IP is specified. This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from Internet through SSH with default Port 22. We need to restrict generic access from Internet to specific IP Range.",
  "source": "cis gcp 1.0.0",
  "properties": {
    "document": {
      "not": {
        "errorMessage": "Firewall rules must access from port 22.",
        "allOf": [
          {
            "properties": {
              "allowed": {
                "items": {
                  "anyOf": [
                    {
                      "properties": {
                        "ports": {
                          "contains": {
                            "errorMessage": "Firewall rules must not include port 22.",
                            "includesPort": 22
                          }
                        }
                      }
                    },
                    {
                      "properties": {
                        "IPProtocol": {
                          "errorMessage": "Firewall rules must not allow all port ranges.",
                          "constIgnoreCase": "all"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          {
            "properties": {
              "sourceRanges": {
                "contains": {
                  "errorMessage": "Firewall rules must not ingress from 0.0.0.0.",
                  "enum": ["0.0.0.0/0", "0.0.0.0"]
                }
              }
            }
          },
          {
            "properties": {
              "direction": {
                "errorMessage": "Firewall rules must not allow all ingress from port 22.",
                "constIgnoreCase": "ingress"
              },
              "disabled": {
                "const": false
              }
            }
          }
        ]
      },
      "errorMessage": "Firewall rules must access from port 22."
    }
  },
  "schemaId": "0b6b41ae-160a-5078-ebba-14919c021b25"
}
