{
  "resourceType": "databases/oracle",
  "id": "8bb33fe2-2151-4c07-80cc-2c4233a4f342",
  "displayName": "Ensure 'EXECUTE' is not granted to 'PUBLIC' on \"Non-default\" Packages",
  "severity": "high",
  "source": "oracle-benchmark",
  "category": "DB",
  "rationale": "As described below, these \"non-default\" group of PL/SQL packages, which are not granted to `PUBLIC` by default, packages should not be granted to `PUBLIC`.\n- The `DBMS_BACKUP_RESTORE` package can allow access to OS files.\n- The `DBMS_FILE_TRANSFER` package could allow to transfer files from one database server to another without authorization to do so.\n- The `DBMS_SYS_SQL` package could allow a user to run code as a different user without entering valid credentials.\n- The `DBMS_REPCAT_SQL_UTL` package could allow an unauthorized user to run SQL commands as user `SYS`.\n- The `INITJVMAUX` package could allow an unauthorized user to run SQL commands as user `SYS`.\n- The `DBMS_AQADM_SYS` package could allow an unauthorized user to run SQL commands as user `SYS`.\n- The `DBMS_STREAMS_RPC` package could allow an unauthorized user to run SQL commands as user `SYS`.\n- The `DBMS_PRVTAQIM` package could allow an unauthorized user to escalate privileges because any SQL statements could be executed as user `SYS`.\n- The `LTADM` package could allow an unauthorized user to run any SQL command as user `SYS`. It allows privilege escalation if granted to unprivileged users.\n- The `DBMS_IJOB` package could allow an attacker to change identities by using a different username to execute a database job. It allows a user to run database jobs in the context of another user.",
  "recommended_action": "To remediate this setting, execute the following SQL statement, keeping in mind if this is granted in both container and pluggable database, you must connect to both places to revoke.\n```\nREVOKE EXECUTE ON DBMS_BACKUP_RESTORE FROM PUBLIC;\nREVOKE EXECUTE ON DBMS_FILE_TRANSFER FROM PUBLIC;\nREVOKE EXECUTE ON DBMS_SYS_SQL FROM PUBLIC;\nREVOKE EXECUTE ON DBMS_REPCAT_SQL_UTL FROM PUBLIC;\nREVOKE EXECUTE ON INITJVMAUX FROM PUBLIC;\nREVOKE EXECUTE ON DBMS_AQADM_SYS FROM PUBLIC;\nREVOKE EXECUTE ON DBMS_STREAMS_RPC FROM PUBLIC;\nREVOKE EXECUTE ON DBMS_PRVTAQIM FROM PUBLIC; \nREVOKE EXECUTE ON LTADM FROM PUBLIC; \nREVOKE EXECUTE ON DBMS_IJOB FROM PUBLIC; \nREVOKE EXECUTE ON DBMS_PDB_EXEC_SQL FROM PUBLIC; \n```",
  "error_message": "'EXECUTE' permissions have been found on one or more 'Non-Default' package",
  "subcategory": "",
  "ruleNames": [
    "Ensure 'EXECUTE' is not granted to 'PUBLIC' on \"Non-default\" Packages"
  ]
}