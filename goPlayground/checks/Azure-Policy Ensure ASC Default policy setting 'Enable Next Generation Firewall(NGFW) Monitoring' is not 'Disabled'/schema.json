{
  "recommended_action": "1. Navigate to Azure Policy\n2. On Policy \"Overview\" blade, Click on Policy ASC Default\n(Subscription:Subscription_ID)\n3. On \"ASC Default\" blade, Click on Edit Assignments\n4. In section PARAMETERS, Set Next Generation Firewall(NGFW) Monitoring to AuditIfNotExists or any\nother available value than Disabled\n5. Click Save",
  "rationale": "When this setting is enabled, it extends network protections beyond network security groups, which are built into Azure. Security Center will search for deployments where a next generation firewall is recommended and enable a virtual appliance to be provisioned.",
  "source": "cis azure 1.1.0",
  "properties": {
    "document": {
      "if": {
        "properties": {
          "name": {
            "constIgnoreCase": "securitycenterbuiltin"
          }
        }
      },
      "then": {
        "properties": {
          "properties": {
            "errorMessage": "Next Generation Firewall monitoring is disabled.",
            "properties": {
              "parameters": {
                "properties": {
                  "nextGenerationFirewallMonitoringEffect": {
                    "properties": {
                      "value": {
                        "minLength": 1,
                        "not": {
                          "errorMessage": "Next Generation Firewall monitoring is disabled.",
                          "constIgnoreCase": "disabled"
                        }
                      }
                    }
                  }
                },
                "required": ["nextGenerationFirewallMonitoringEffect"]
              }
            },
            "required": ["parameters"]
          }
        }
      },
      "errorMessage": "Next Generation Firewall monitoring is disabled."
    }
  },
  "schemaId": "fad3faa2-d3d5-478d-edec-82483c88d9d9"
}
