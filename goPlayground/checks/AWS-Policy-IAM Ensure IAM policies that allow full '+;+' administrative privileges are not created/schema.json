{
  "status": "incomplete",
  "recommended_action": "Using the GUI, perform the following to detach the policy that has full administrative privileges:\n1. Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/iam/.\n2. In the navigation pane, click Policies and then search for the policy name found in the audit step.\n3. Select the policy that needs to be deleted.\n4. In the policy action menu, select first Detach\n5. Select all Users, Groups, Roles that have this policy attached\n6. Click Detach Policy\n7. In the policy action menu, select Detach",
  "rationale": "It's more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions.",
  "source": "cis aws 1.2.0",
  "properties": {
    "document": {
      "properties": {
        "Policy": {
          "properties": {
            "Document": {
              "properties": {
                "Statement": {
                  "items": {
                    "not": {
                      "errorMessage": "IAM policy allows full administrative permissions.",
                      "allOf": [
                        {
                          "properties": {
                            "Effect": {
                              "constIgnoreCase": "allow"
                            }
                          }
                        },
                        {
                          "properties": {
                            "Action": {
                              "const": "*"
                            }
                          }
                        },
                        {
                          "properties": {
                            "Resource": {
                              "const": "*"
                            }
                          }
                        }
                      ]
                    },
                    "errorMessage": "IIAM policy allows full administrative permissions."
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "schemaId": "bb9c9fdc-f839-7e07-061e-2a364ffd07cb"
}
