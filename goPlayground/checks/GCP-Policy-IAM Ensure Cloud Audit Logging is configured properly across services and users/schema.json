{
  "recommended_action": "1. To Read project's IAM policy and store it in a file run a command:\ngcloud projects get-iam-policy [PROJECT_ID] > /tmp/policy.yaml\n2. Edit policy in /tmp/policy.yaml, adding or changing only the audit logs\nconfiguration to:\nauditConfigs:\n- auditLogConfigs:\n- logType: DATA_WRITE\n- logType: DATA_READ\nservice: allServices\nNote: exemptedMembers: is not set as audit logging should be enabled for all the users\n3. To write new IAM policy run command:\ngcloud projects set-iam-policy [PROJECT_ID] /tmp/policy.yaml\nIf the preceding command reports a conflict with another change, then repeat these steps,\nstarting with the first step",
  "rationale": "Cloud Audit Logging maintains two audit logs for each project and organization: Admin Activity and Data Access.\n1.Admin Activity logs contain log entries for API calls or other administrative actions that modify the configuration or metadata of resources. Admin Activity audit logsare enabled for all services and cannot be configured.\n2.Data Access audit logs record API calls that create, modify, or read user-provided data. These are disabled by default and should be enabled.\nThere are three kinds of Data Access audit log information:\noAdmin read: Records operations that read metadata or configuration information. Admin Activity audit logs record writes of metadata and configuration information which cannot be disabled.\noData read: Records operations that read user-provided data.\noData write: Records operations that write user-provided data.\nIt is recommended to have effective default audit config configured in such a way that:\n1.logtype is set to DATA_READ (to logs user activity tracking) and DATA_WRITES (to log changes/tampering to user data)\n2.audit config is enabled for all the services supported by Data Access audit logs featuren\n3.Logs should be captured for all users. i.e. there are no exempted users in any of the audit config section. This will ensure overriding audit config will not contradict the requirement.",
  "source": "cis gcp 1.0.0",
  "properties": {
    "document": {
      "properties": {
        "auditConfigs": {
          "contains": {
            "properties": {
              "service": {
                "errorMessage": "Cloud audit logging is not configured correctly.",
                "constIgnoreCase": "allservices"
              },
              "auditLogConfigs": {
                "allOf": [
                  {
                    "contains": {
                      "properties": {
                        "logType": {
                          "errorMessage": "Audit log configuration does not exist for DATA_READ.",
                          "constIgnoreCase": "data_read"
                        },
                        "exemptedMembers": {
                          "errorMessage": "Exempted members exist for DATA_READ.",
                          "maxItems": 0
                        }
                      }
                    }
                  },
                  {
                    "contains": {
                      "properties": {
                        "logType": {
                          "errorMessage": "Audit log configuration does not exist for DATA_READ.",
                          "constIgnoreCase": "data_write"
                        },
                        "exemptedMembers": {
                          "errorMessage": "Exempted members exist for DATA_WRITE.",
                          "maxItems": 0
                        }
                      }
                    }
                  }
                ]
              }
            }
          }
        }
      },
      "errorMessage": "Cloud audit logging settings cannot be verified.",
      "required": ["auditConfigs"]
    }
  },
  "schemaId": "0074fd54-fe03-097f-d6b8-8a0e8107059a"
}
