{
  "id": "3885c85e-97c2-4fea-baf7-cf0df2e6612e",
  "displayName": "Ensure 'Symmetric Key encryption algorithm' is set to 'AES_128' or higher in non-system databases",
  "resourceType": "databases/mssqlserver",
  "severity": "medium",
  "rationale": "The following algorithms (as referred to by SQL Server) are considered weak or deprecated and should no longer be used in SQL Server: `DES`, `DESX`, `RC2`, `RC4`, `RC4_128`.\r\n\r\nMany organizations may accept the Triple DES algorithms (`TDEA`) which use keying options 1 (3 key aka `3TDEA`) or keying option 2 (2 key aka `2TDEA`). In SQL Server, these are referred to as `TRIPLE_DES_3KEY` and `TRIPLE_DES` respectively. Additionally, the SQL Server algorithm named DESX is actually the same implementation as the `TRIPLE_DES_3KEY` option. However, using the DESX identifier as the algorithm type has been deprecated and its usage is now discouraged.",
  "source": "sql-server benchmark",
  "recommended_action": "Refer to Microsoft SQL Server Books Online ALTER SYMMETRIC KEY entry: [https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-symmetric-key-transact-sql](https://docs.microsoft.com/en-us/sql/t-sql/statements/alter-symmetric-key-transact-sql)",
  "error_message": "Encryption algorithm on one or more databases is noncompliant",
  "subcategory": "",
  "category": "",
  "ruleNames": [
    "Ensure 'Symmetric Key encryption algorithm' is set to 'AES_128' or higher in non-system databases"
  ]
}