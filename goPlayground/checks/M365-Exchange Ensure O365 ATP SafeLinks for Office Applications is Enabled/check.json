{
  "id": "d0645374-f08f-da0d-d773-0cf5323cc55d",
  "displayName": "Ensure Safe Links for Office Applications is Enabled",
  "resourceType": "exchange/AtpPolicy",
  
  "severity": "medium",
  "rationale": "Safe Links for Office applications extends phishing protection to documents and emails that contain hyperlinks, even after they have been delivered to a user.",
  "source": "cis o365 1.1.0 | benchmark 2.3",
  "recommended_action": "**To enable Defender for Office Safe Links policy for Office, use the Microsoft 365 Admin Center:**\r\n\r\n1. Under `Admin centers` click `Security`.\r\n2. Under `Email & collaboration` select `Policies & rules`\r\n3. Select `Threat policies` then `Safe Links`\r\n4. Click on the policy, a new pane should open on the right hand side.\r\n5. Under `Protection settings` click `Edit protection settings`\r\n6. Ensure the follow boxes are checked:\r\n- `On: Safe Links checks a list of known, malicious links when users click links in email. URLs are rewritten by default`\r\n- `Apply Safe Links to email messages sent within the organization`\r\n- `Apply real-time URL scanning for suspicious links and links that point to files`\r\n- `Wait for URL scanning to complete before delivering the message`\r\n- `On: Safe Links checks a list of known, malicious links when users click links in Microsoft Teams. URLs are not rewritten`\r\n- `On: Safe Links checks a list of known, malicious links when users click links in Microsoft Office apps. URLs are not rewritten`\r\n7. Under `Click protection settings` check `Track user clicks` and **uncheck** `Let users click through to the original URL`\r\n8. Select `Save`\r\n\r\n**To enable the Safe Links policy for Office 365, use the Exchange Online PowerShell Module:**\r\n\r\n1. Connect using `Connect-ExchangeOnline`.\r\n2. Run the following PowerShell command:\r\n\r\n```\r\nNew-SafeLinksPolicy -Name \"My SafeLinks Policy\" -EnableSafeLinksForEmail $true -EnableSafeLinksForTeams $true -EnableSafeLinksForOffice $true -ScanUrls $true -DeliverMessageAfterScan $true -EnableForInternalSenders $true -AllowClickThrough $false\r\n```",
  "error_message": "ATP policy is incorrectly set",
  "category": "AP",
  "subcategory": "",
  "ruleNames": [
    "Ensure O365 ATP SafeLinks for Office applications is enabled"
  ]
}