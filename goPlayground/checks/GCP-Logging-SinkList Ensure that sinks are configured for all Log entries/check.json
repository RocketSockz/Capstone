{
  "id": "b3116eb5-a5ed-52ad-917d-cb708d2e521d",
  "displayName": "Ensure that sinks are configured for all Log entries",
  "resourceType": "logging#sinkList",
  "severity": "high",
  "rationale": "Log entries are held in Stackdriver Logging for a limited time known as the retention period. After that, the entries are deleted. To keep log entries longer, sink can export them outside of Stackdriver Logging. Exporting involves writing a filter that selects the log entries to export, and choosing a destination in Cloud Storage, BigQuery, or Cloud Pub/Sub. The filter and destination are held in an object called a sink. To ensure all log entries are exported using sink ensure that there is no filter configured for a sink. Sinks can be created in projects, organizations, folders, and billing accounts.",
  "source": "cis gcp 1.0.0 | benchmark 2.2",
  "recommended_action": "1. Go to Logging/Logs by visiting https://console.cloud.google.com/logs/viewer?\n2. Click down arrow symbol on Filter Bar at rightmost corner and select Convert to\nAdvanced Filter\n3. This will convert Filter Bar to Advanced Filter Bar\n4. Clear any text from Advanced Filter - This will ensure that log-filter is set to\nempty and hence it captures all the logs\n5. Click on Submit Filter and should display all logs\n6. Click Create Export it will open Edit Export Menu on right\n7. Configure Sink Name. In sink service click drop down select destination and\nselect desired service to store exports, preferably Cloud Storage\n8. In Select Destination click drop down and select desired destination resource or\nIf required create new.\n9. Click Create Sink",
  "error_message": "Sink with an empty filter does not exist",
  "category": "AU",
  "subcategory": "",
  "ruleNames": [
    "Ensure logging is enabled"
  ]
}