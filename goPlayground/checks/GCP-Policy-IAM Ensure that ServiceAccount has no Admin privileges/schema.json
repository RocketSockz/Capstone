{
  "recommended_action": "1. Go to IAM & admin/IAM using https://console.cloud.google.com/iam-admin/iam\n2. Go to the Members\n3. Identify User-Managed user created service account with roles containing *Admin\nor role matching Editor or role matching Owner\n4. Click Delete bin icon to remove role from member (service account in this case)",
  "rationale": "Service accounts represent service-level security of the Resources (application or a VM) which can be determined by the roles assigned to it. Enrolling ServiceAccount with Admin rights gives full access to assigned application or a VM, ServiceAccount Access holder can perform critical actions like delete, update change settings etc. without the intervention of user, so It's recommended not to have Admin rights.\nThis recommendation is applicable only for User-Managed user created service account (Service account with nomenclature: SERVICE_ACCOUNT_NAME@PROJECT_ID.iam.gserviceaccount.com).",
  "source": "cis gcp 1.0.0",
  "properties": {
    "document": {
      "properties": {
        "bindings": {
          "not": {
            "errorMessage": "User-managed service account has the role of editor, owner, or is an admin of some sort.",
            "contains": {
              "properties": {
                "role": {
                  "anyOf": [
                    {
                      "constIgnoreCase": "roles/editor"
                    },
                    {
                      "constIgnoreCase": "roles/owner"
                    },
                    {
                      "pattern": "admin"
                    },
                    {
                      "pattern": "Admin"
                    }
                  ]
                },
                "members": {
                  "contains": {
                    "allOf": [
                      {
                        "pattern": {
                          "$data": "/projectId/projectId/"
                        }
                      },
                      {
                        "pattern": ".iam.gserviceaccount.com"
                      }
                    ]
                  }
                }
              }
            }
          },
          "errorMessage": "User-managed service account has the role of editor, owner, or is an admin of some sort."
        }
      }
    }
  },
  "schemaId": "06df752e-417f-d304-04b0-98b855e59fed"
}
